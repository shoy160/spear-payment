(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6d24"],{"08qT":function(e,t,a){"use strict";var n=a("ed65");a.n(n).a},"7UaX":function(e,t,a){"use strict";a.r(t);var n=a("HTsy"),l=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,function(){return n[e]})}(s);t.default=l.a},HTsy:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(a("P2sY")),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a("JNL0")),s=a("bfoT"),i=a("XJYT");t.default={name:"Project",data:function(){return{modalVisible:!1,dialogStatus:"create",role:0,dialogTitleMap:{create:"添加支付项目",update:"编辑支付项目"},temp:{},rules:{code:[{required:!0,message:"请输入项目编码",trigger:"blur"}],name:[{required:!0,message:"请输入项目名称",trigger:"blur"}]},channels:[],defaultChannels:[],total:0,query:{keyword:"",status:"",page:1,size:10},listLoading:!0,statusList:[{text:"正常",value:0},{text:"删除",value:4}],list:[]}},mounted:function(){this.getList(),this.role=this.$store.getters.role},methods:{getChannels:function(){var e=this;this.channels.length>0||(0,s.list)({status:2,page:1,size:500}).then(function(t){for(var a in t.data){var n=t.data[a];n.isDefault&&e.defaultChannels.push(n.id),e.channels.push({id:n.id,name:n.name,types:n.types})}})},getList:function(){var e=this;this.listLoading=!0,l.list(this.query).then(function(t){e.list=t.data,e.total=t.total,e.listLoading=!1})},handleSearch:function(){this.query.page=1,this.getList()},handleCreate:function(){var e=this;this.getChannels(),this.modalVisible=!0,this.dialogStatus="create",this.temp={code:"",name:"",notifyUrl:"",redirectUrl:"",channels:this.defaultChannels,channelModels:[]},this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleEdit:function(e,t){var a=this;this.getChannels(),this.modalVisible=!0,this.dialogStatus="update",this.temp=(0,n.default)({},t),this.$nextTick(function(){a.$refs.dataForm.clearValidate()})},handleDelete:function(e,t){var a=this;this.$confirm("确认要删除该项目？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"danger"}).then(function(){l.remove(t.id).then(function(){a.getList(),(0,i.Message)({message:"删除成功",type:"success"})})}).catch(function(){})},handleSubmit:function(){var e=this;this.$refs.dataForm.validate(function(t){t&&("update"===e.dialogStatus?l.edit(e.temp.id,e.temp).then(function(){e.getList(),(0,i.Message)({message:"编辑成功",type:"success"}),e.modalVisible=!1}):l.add(e.temp).then(function(t){e.getList(),(0,i.Message)({message:"添加成功",type:"success"}),e.modalVisible=!1}))})},handleSizeChange:function(e){this.query.size=e,this.query.page=1,this.getList()},handleCurrentChange:function(e){this.query.page=e,this.getList()},handleChangeSecret:function(){var e=this;this.$confirm("更新项目密钥将会影响项目支付，确认更新？").then(function(){l.updateSecret(e.temp.id).then(function(){e.$message.success("更新成功"),e.getList(),e.modalVisible=!1})})}}}},JNL0:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.list=t.remove=t.updateSecret=t.edit=t.add=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(a("t3Un"));t.add=function(e){return n.default.post("/manage/project",e)},t.edit=function(e,t){return n.default.put("/manage/project/"+e,t)},t.updateSecret=function(e){return n.default.put("/manage/project/secret/"+e)},t.remove=function(e){return n.default.delete("/manage/project/"+e)},t.list=function(e){return n.default.get("/manage/project",{params:e})}},bfoT:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.list=t.setDefault=t.setStatus=t.edit=t.add=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(a("t3Un"));t.add=function(e){return n.default.post("/manage/channel",e)},t.edit=function(e,t){return n.default.put("/manage/channel/"+e,t)},t.setStatus=function(e,t){return n.default.put("/manage/channel/status/"+e+"?status="+t)},t.setDefault=function(e,t){return n.default.put("/manage/channel/default/"+e+"?isDefault="+t,{})},t.list=function(e){return n.default.get("/manage/channel",{params:e})}},ed65:function(e,t,a){},kK2Z:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[64===e.role?a("div",{staticClass:"app-container"},[a("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"项目名称/项目编码"},model:{value:e.query.keyword,callback:function(t){e.$set(e.query,"keyword",t)},expression:"query.keyword"}}),e._v(" "),a("el-select",{attrs:{clearable:"",placeholder:"项目状态"},model:{value:e.query.status,callback:function(t){e.$set(e.query,"status",t)},expression:"query.status"}},e._l(e.statusList,function(e){return a("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v(e._s(e.$t("table.search")))])],1):e._e(),e._v(" "),64===e.role?a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("添加项目")])],1)],1):e._e(),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"table-expand",attrs:{inline:""}},[a("el-form-item",{attrs:{label:"项目密钥"}},[a("span",[e._v(e._s(t.row.secret))])]),e._v(" "),a("el-form-item",{attrs:{label:"异步通知"}},[a("span",[e._v(e._s(t.row.notifyUrl))])]),e._v(" "),a("el-form-item",{attrs:{label:"同步跳转"}},[a("span",[e._v(e._s(t.row.redirectUrl))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{type:"index"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.code"),prop:"code"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.name"),prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.channel")},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.channelModels,function(t){return a("el-tag",{key:t.id,attrs:{type:"info"}},[e._v(e._s(t.name)+e._s(e._f("showTypes")(t.types)))])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.date"),prop:"createTime",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("parseTime")(t.row.createTime,"{y}-{m}-{d} {h}:{i}"))+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.status")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s(t.row.statusCn))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.actions")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{title:e.$t("table.edit"),size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(a){e.handleEdit(t.$index,t.row)}}}),e._v(" "),64===e.role?a("el-button",{attrs:{title:e.$t("table.delete"),size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){e.handleDelete(t.$index,t.row)}}}):e._e()]}}])})],1),e._v(" "),64===e.role?a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{total:e.total,"page-sizes":[10,20,30,50],background:"",layout:"total, sizes, prev, pager, next"},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1):e._e(),e._v(" "),a("el-dialog",{attrs:{visible:e.modalVisible,title:e.dialogTitleMap[e.dialogStatus]},on:{"update:visible":function(t){e.modalVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.temp,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"项目编码",prop:"code"}},[a("el-col",{attrs:{span:11}},[a("el-input",{attrs:{disabled:"update"===e.dialogStatus},model:{value:e.temp.code,callback:function(t){e.$set(e.temp,"code",t)},expression:"temp.code"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"项目名称",prop:"name"}},[a("el-col",{attrs:{span:11}},[a("el-input",{model:{value:e.temp.name,callback:function(t){e.$set(e.temp,"name",t)},expression:"temp.name"}})],1)],1),e._v(" "),"update"===e.dialogStatus?a("el-form-item",{attrs:{label:"项目密钥",prop:"secret"}},[a("el-col",{attrs:{span:11}},[a("el-input",{attrs:{disabled:""},model:{value:e.temp.secret,callback:function(t){e.$set(e.temp,"secret",t)},expression:"temp.secret"}},[a("template",{slot:"append"},[a("el-button",{on:{click:e.handleChangeSecret}},[e._v("更新")])],1)],2)],1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"登陆密码",prop:"password"}},[a("el-col",{attrs:{span:11}},[a("el-input",{attrs:{type:"password"},model:{value:e.temp.password,callback:function(t){e.$set(e.temp,"password",t)},expression:"temp.password"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"队列名称"}},[a("el-col",{attrs:{span:11}},[a("el-input",{model:{value:e.temp.queueName,callback:function(t){e.$set(e.temp,"queueName",t)},expression:"temp.queueName"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"异步通知"}},[a("el-input",{model:{value:e.temp.notifyUrl,callback:function(t){e.$set(e.temp,"notifyUrl",t)},expression:"temp.notifyUrl"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"同步回调"}},[a("el-input",{model:{value:e.temp.redirectUrl,callback:function(t){e.$set(e.temp,"redirectUrl",t)},expression:"temp.redirectUrl"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"支付渠道"}},[a("el-checkbox-group",{model:{value:e.temp.channels,callback:function(t){e.$set(e.temp,"channels",t)},expression:"temp.channels"}},e._l(e.channels,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name)+e._s(e._f("showTypes")(t.types)))])}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.modalVisible=!1}}},[e._v(e._s(e.$t("table.cancel")))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v(e._s(e.$t("table.confirm")))])],1)],1)],1)},l=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return l})},xNwF:function(e,t,a){"use strict";a.r(t);var n=a("kK2Z"),l=a("7UaX");for(var s in l)"default"!==s&&function(e){a.d(t,e,function(){return l[e]})}(s);a("08qT");var i=a("KHd+"),r=Object(i.a)(l.default,n.a,n.b,!1,null,null,null);r.options.__file="index.vue",t.default=r.exports}}]);
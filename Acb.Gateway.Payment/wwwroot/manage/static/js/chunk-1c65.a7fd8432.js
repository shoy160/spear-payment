(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1c65"],{"+n5z":function(e,t,a){"use strict";a.r(t);var n=a("gAv6"),l=a("qwrs");for(var i in l)"default"!==i&&function(e){a.d(t,e,function(){return l[e]})}(i);a("53eT");var s=a("KHd+"),r=Object(s.a)(l.default,n.a,n.b,!1,null,"28fbdcc9",null);r.options.__file="index.vue",t.default=r.exports},"/CaU":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a("GQeE")),l=c(a("P2sY")),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a("bfoT")),s=a("XJYT"),r=c(a("+n5z")),u=c(a("iylE")),o=a("7Qib");function c(e){return e&&e.__esModule?e:{default:e}}t.default={name:"Channel",components:{JsonEditor:r.default,CodeViewer:u.default},data:function(){return{modalVisible:!1,dialogStatus:"create",dialogTitleMap:{create:"添加支付渠道",update:"编辑支付渠道"},temp:{},rules:{mode:[{required:!0,message:"请选择支付方式",trigger:"change"}],name:[{required:!0,message:"请输入渠道名称",trigger:"blur"}],appId:[{required:!0,message:"请输入渠道商户ID",trigger:"blur"}],config:[{required:!0,message:"请输入渠道配置",trigger:"blur"}]},statusList:[{text:"已创建",value:0},{text:"已验证",value:1},{text:"已启用",value:2},{text:"已删除",value:4}],modes:o.paymentModes,types:[],checkAll:!1,isIndeterminate:!1,query:{keyword:"",mode:"",page:1,size:10},total:0,list:[]}},mounted:function(){for(var e in this.getList(),o.paymentTypes)o.paymentTypes.hasOwnProperty(e)&&this.types.push({text:o.paymentTypes[e],value:~~e})},methods:{getList:function(){var e=this;i.list(this.query).then(function(t){e.total=t.total,e.list=t.data})},handleSearch:function(){this.query.page=1,this.getList()},handlePageChange:function(e){this.query.page=e,this.getList()},handleSizeChange:function(e){this.query.size=e,this.query.page=1,this.getList()},handleCreate:function(){var e=this;this.modalVisible=!0,this.dialogStatus="create",this.temp={name:"",remark:"",mode:0,types:[],appId:"",config:(0,l.default)({},o.paymentSettings[0])},this.checkAll=!1,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},handleModeChange:function(){this.modalVisible&&"create"===this.dialogStatus&&(this.temp.config=(0,l.default)({},o.paymentSettings[this.temp.mode]))},handleCheckAllChange:function(e){this.temp.types=e?(0,n.default)(o.paymentTypes):[],this.isIndeterminate=!1},handleTypesChange:function(e){this.checkAll=e.length===this.types.length,this.isIndeterminate=e.length>0&&!this.checkAll},handleEdit:function(e,t){var a=this;this.modalVisible=!0,this.dialogStatus="update",this.temp=(0,l.default)({},t),this.checkAll=this.temp.types.length===this.types.length,this.isIndeterminate=this.temp.types.length>0&&!this.checkAll,this.$nextTick(function(){a.$refs.dataForm.clearValidate()})},handleDelete:function(e,t){var a=this;this.$confirm("确认要删除该支付渠道吗？").then(function(){i.setStatus(t.id,4).then(function(){a.$message.success("删除成功"),a.getList()})}),console.log(t)},handleDefault:function(e,t){var a=this;console.log(t),i.setDefault(t.id,!t.isDefault).then(function(){a.getList(),(0,s.Message)({message:"设置成功",type:"success"})})},handleEnabled:function(e,t){var a=this;console.log(t);var n=0;1===t.status?n=2:2===t.status&&(n=1),0!==n&&i.setStatus(t.id,n).then(function(){a.getList(),(0,s.Message)({message:"设置成功",type:"success"})})},handleFilter:function(e,t,a){return t[a.property]===e},handleSubmit:function(){var e=this;this.$refs.dataForm.validate(function(t){t&&("update"===e.dialogStatus?i.edit(e.temp.id,e.temp).then(function(){e.getList(),(0,s.Message)({message:"编辑成功",type:"success"}),e.modalVisible=!1}):i.add(e.temp).then(function(t){e.getList(),(0,s.Message)({message:"添加成功",type:"success"}),e.modalVisible=!1}))})}}}},"2//y":function(e,t,a){"use strict";var n=a("aFkk");a.n(n).a},"2VEV":function(e,t,a){"use strict";a.r(t);var n=a("/CaU"),l=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,function(){return n[e]})}(i);t.default=l.a},"53eT":function(e,t,a){"use strict";var n=a("LEVG");a.n(n).a},"8GaU":function(e,t,a){"use strict";a.r(t);var n=a("r8Ia"),l=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,function(){return n[e]})}(i);t.default=l.a},FpHO:function(e,t,a){"use strict";var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"code-viewer"},[t("textarea",{ref:"textarea"})])},l=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return l})},G6Fx:function(e,t,a){"use strict";a.r(t);var n=a("dSe8"),l=a("2VEV");for(var i in l)"default"!==i&&function(e){a.d(t,e,function(){return l[e]})}(i);var s=a("KHd+"),r=Object(s.a)(l.default,n.a,n.b,!1,null,null,null);r.options.__file="index.vue",t.default=r.exports},LEVG:function(e,t,a){},aFkk:function(e,t,a){},bfoT:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.list=t.setDefault=t.setStatus=t.edit=t.add=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(a("t3Un"));t.add=function(e){return n.default.post("/manage/channel",e)},t.edit=function(e,t){return n.default.put("/manage/channel/"+e,t)},t.setStatus=function(e,t){return n.default.put("/manage/channel/status/"+e+"?status="+t)},t.setDefault=function(e,t){return n.default.put("/manage/channel/default/"+e+"?isDefault="+t,{})},t.list=function(e){return n.default.get("/manage/channel",{params:e})}},dSe8:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("div",{staticClass:"app-container"},[a("el-input",{staticStyle:{width:"280px"},attrs:{placeholder:"商户ID/渠道名称"},model:{value:e.query.keyword,callback:function(t){e.$set(e.query,"keyword",t)},expression:"query.keyword"}}),e._v(" "),a("el-select",{attrs:{clearable:"",placeholder:"支付类型"},model:{value:e.query.mode,callback:function(t){e.$set(e.query,"mode",t)},expression:"query.mode"}},e._l(e.modes,function(e){return a("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})),e._v(" "),a("el-select",{attrs:{clearable:"",placeholder:"渠道状态"},model:{value:e.query.status,callback:function(t){e.$set(e.query,"status",t)},expression:"query.status"}},e._l(e.statusList,function(e){return a("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v(e._s(e.$t("table.search")))])],1),e._v(" "),a("el-row",{attrs:{type:"flex",justify:"end"}},[a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleCreate}},[e._v("添加支付渠道")])],1)],1),e._v(" "),a("el-table",{attrs:{data:e.list}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("code-viewer",{model:{value:t.row.config,callback:function(a){e.$set(t.row,"config",a)},expression:"props.row.config"}}),e._v(" "),a("el-form",{staticClass:"table-expand",attrs:{inline:""}},[a("el-form-item",{attrs:{label:"渠道备注"}},[a("span",[e._v(e._s(t.row.remark))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{type:"index"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.paymode"),filters:e.modes,"filter-method":e.handleFilter,prop:"mode"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:["primary","success"][t.row.mode]}},[e._v(e._s(t.row.modeCn))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.types"),prop:"types"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.types.length>0?e._l(t.row.types,function(t){return a("el-tag",{key:t},[e._v(e._s(e._f("paymentType")(t)))])}):[a("el-tag",{attrs:{type:"success"}},[e._v("全部类型")])]]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.name"),prop:"name"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.date"),prop:"createTime",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("parseTime")(t.row.createTime,"{y}-{m}-{d} {h}:{i}"))+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.status"),prop:"status",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:["info","","success","","danger"][t.row.status]}},[e._v(e._s(t.row.statusCn))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.isEnabled")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{value:t.row.status,disabled:t.row.isDefault||1!==t.row.status&&2!==t.row.status,"active-value":2,"inactive-value":1,"active-color":"#409EFF","inactive-color":"#999"},on:{change:function(a){e.handleEnabled(t.$index,t.row)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.isDefault")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{value:t.row.isDefault,disabled:2!==t.row.status,"active-color":"#13ce66","inactive-color":"#999"},on:{change:function(a){e.handleDefault(t.$index,t.row)}}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("table.actions")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{title:e.$t("table.edit"),size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(a){e.handleEdit(t.$index,t.row)}}}),e._v(" "),a("el-button",{attrs:{disabled:0!==t.row.status&&1!==t.row.status,title:e.$t("table.delete"),size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){e.handleDelete(t.$index,t.row)}}})]}}])})],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{total:e.total,"page-sizes":[10,20,30,50],background:"",layout:"total, sizes, prev, pager, next"},on:{"current-change":e.handlePageChange,"size-change":e.handleSizeChange},model:{value:e.query.page,callback:function(t){e.$set(e.query,"page",t)},expression:"query.page"}})],1),e._v(" "),a("el-dialog",{attrs:{visible:e.modalVisible,title:e.dialogTitleMap[e.dialogStatus]},on:{"update:visible":function(t){e.modalVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{rules:e.rules,model:e.temp,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"支付方式",prop:"mode"}},[a("el-select",{attrs:{disabled:"update"===e.dialogStatus},on:{change:e.handleModeChange},model:{value:e.temp.mode,callback:function(t){e.$set(e.temp,"mode",t)},expression:"temp.mode"}},e._l(e.modes,function(e){return a("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"支付类型",prop:"mode"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),a("div",{staticStyle:{margin:"15px 0"}}),e._v(" "),a("el-checkbox-group",{on:{change:e.handleTypesChange},model:{value:e.temp.types,callback:function(t){e.$set(e.temp,"types",t)},expression:"temp.types"}},e._l(e.types,function(t){return a("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.text))])}))],1),e._v(" "),a("el-form-item",{attrs:{label:"应用ID",prop:"appId"}},[a("el-col",{attrs:{span:11}},[a("el-input",{model:{value:e.temp.appId,callback:function(t){e.$set(e.temp,"appId",t)},expression:"temp.appId"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"渠道名称",prop:"name"}},[a("el-col",{attrs:{span:11}},[a("el-input",{model:{value:e.temp.name,callback:function(t){e.$set(e.temp,"name",t)},expression:"temp.name"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"渠道备注",prop:"remark"}},[a("el-input",{attrs:{rows:2,type:"textarea"},model:{value:e.temp.remark,callback:function(t){e.$set(e.temp,"remark",t)},expression:"temp.remark"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"渠道配置",prop:"config"}},[a("json-editor",{ref:"jsonEditor",model:{value:e.temp.config,callback:function(t){e.$set(e.temp,"config",t)},expression:"temp.config"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.modalVisible=!1}}},[e._v(e._s(e.$t("table.cancel")))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v(e._s(e.$t("table.confirm")))])],1)],1)],1)},l=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return l})},gAv6:function(e,t,a){"use strict";var n=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"json-editor"},[t("textarea",{ref:"textarea"})])},l=[];a.d(t,"a",function(){return n}),a.d(t,"b",function(){return l})},iylE:function(e,t,a){"use strict";a.r(t);var n=a("FpHO"),l=a("8GaU");for(var i in l)"default"!==i&&function(e){a.d(t,e,function(){return l[e]})}(i);a("2//y");var s=a("KHd+"),r=Object(s.a)(l.default,n.a,n.b,!1,null,"22e8bd9b",null);r.options.__file="index.vue",t.default=r.exports},qwrs:function(e,t,a){"use strict";a.r(t);var n=a("sMna"),l=a.n(n);for(var i in n)"default"!==i&&function(e){a.d(t,e,function(){return n[e]})}(i);t.default=l.a},r8Ia:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a("gDS+")),l=s(a("EJiy")),i=s(a("VrN/"));function s(e){return e&&e.__esModule?e:{default:e}}a("DdDu"),a("p77/"),a("uGbe"),a("+dQi"),a("1eCo"),a("iCJ0"),a("0t4y"),a("rmfV"),t.default={name:"CodeViewer",props:{value:{require:!0,default:function(){return{}}},lineNumbers:{type:Boolean,require:!1,default:!0},theme:{type:String,require:!1,default:"idea"}},data:function(){return{codeViewer:!1}},computed:{isXml:function(){return"string"==typeof this.value&&/^<[0-9a-z]+>/gi.test(this.value)},isJson:function(){if("string"==typeof this.value)try{var e=JSON.parse(this.value);return"object"===(void 0===e?"undefined":(0,l.default)(e))&&e}catch(e){return!1}return"object"===(0,l.default)(this.value)&&this.value}},watch:{value:function(e){e!==this.codeViewer.getValue()&&this.setValue()}},mounted:function(){var e=this,t="text/html";this.isXml?t="application/xml":this.isJson&&(t="application/json"),this.codeViewer=i.default.fromTextArea(this.$refs.textarea,{lineNumbers:this.lineNumbers,mode:t,gutters:["CodeMirror-lint-markers"],theme:this.theme,lineWrapping:!0,lint:!0,readOnly:!0}),this.setValue(),this.codeViewer.on("change",function(t){e.$emit("changed",t.getValue()),e.$emit("input",t.getValue())})},methods:{setValue:function(){if(this.isJson){var e="string"==typeof this.value?JSON.parse(this.value):this.value;this.codeViewer.setValue((0,n.default)(e,null,2))}else this.codeViewer.setValue(this.value)},getValue:function(){return this.codeViewer.getValue()}}}},sMna:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a("gDS+")),l=i(a("VrN/"));function i(e){return e&&e.__esModule?e:{default:e}}a("DdDu"),a("p77/"),a("uGbe"),a("+dQi"),a("iCJ0"),a("0t4y"),a("rmfV"),t.default={name:"JsonEditor",props:{value:{require:!0,default:function(){return{}}},lineNumbers:{type:Boolean,require:!1,default:!0},type:{type:String,require:!1,default:"application/json"},theme:{type:String,require:!1,default:"idea"}},data:function(){return{jsonEditor:!1}},watch:{value:function(e){e!==this.jsonEditor.getValue()&&this.setValue()}},mounted:function(){var e=this;this.jsonEditor=l.default.fromTextArea(this.$refs.textarea,{lineNumbers:this.lineNumbers,mode:this.type,gutters:["CodeMirror-lint-markers"],theme:this.theme,lineWrapping:!0,lint:!0}),this.setValue(),this.jsonEditor.on("change",function(t){e.$emit("changed",t.getValue()),e.$emit("input",t.getValue())})},methods:{setValue:function(){var e="string"==typeof this.value?JSON.parse(this.value):this.value;this.jsonEditor.setValue((0,n.default)(e,null,2))},getValue:function(){return this.jsonEditor.getValue()}}}}}]);